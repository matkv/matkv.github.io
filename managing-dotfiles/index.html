<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Managing dotfiles | matkv.dev</title>
<link rel=stylesheet href=/css/main.css integrity crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css><link disabled id=dark-css rel=stylesheet href=/css/dark.css><link id=light-syntax rel=stylesheet href=/css/syntax-light.css><link id=dark-syntax rel=stylesheet href=/css/syntax-dark.css disabled></head><body><header><div class=websitetitle><h1><a href=/>matkv.dev</a></h1></div><nav><ul><li><a href=/about>About</a></li><li><a href=/micro-blog>Micro blog</a></li><li><a href=/tags>Tags</a></li><li><a href=/archive>Archive</a></li><div class=darkmodemenutoggle><li><i id=darkmodeswitch class=iconoir-half-moon></i>
<script>var savedTheme,toggle=document.getElementById("darkmodeswitch"),darkTheme=document.getElementById("dark-css"),lightSyntax=document.getElementById("light-syntax"),darkSyntax=document.getElementById("dark-syntax");toggle.addEventListener("click",()=>{toggle.className==="iconoir-half-moon"?setTheme("dark"):toggle.className==="iconoir-sun-light"&&setTheme("light")}),savedTheme=localStorage.getItem("dark-mode-storage")||"light",setTheme(savedTheme);function setTheme(e){localStorage.setItem("dark-mode-storage",e),e==="dark"?(darkTheme.disabled=!1,darkSyntax.disabled=!1,lightSyntax.disabled=!0,toggle.className="iconoir-sun-light"):e==="light"&&(darkTheme.disabled=!0,darkSyntax.disabled=!0,lightSyntax.disabled=!1,toggle.className="iconoir-half-moon")}</script></li></div></ul></nav><hr></header><main><h1>Managing dotfiles</h1><div class=toc><hr><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#initial-setup>Initial setup</a></li><li><a href=#viewing-all-currently-tracked-files>Viewing all currently tracked files</a></li><li><a href=#setting-up-this-existing-repository-on-a-new-system>Setting up this existing repository on a new system</a></li><li><a href=#next-steps>Next steps</a></li></ul></nav><hr></div><p>I finally got around to setting up a way to manage my dotfiles - using a Git bare repository. This blog post a tutorial for future reference in order to be able to replicate this setup on a different computer.</p><p>I mainly followed <a href=https://www.atlassian.com/git/tutorials/dotfiles>this</a> tutorial from Bitbucket & <a href=https://www.ackama.com/what-we-think/the-best-way-to-store-your-dotfiles-a-bare-git-repository-explained/>another one</a> that goes a bit more into detail.</p><p>In these tutorials, they&rsquo;re using <strong>.cfg</strong> as the folder name for the dotfiles repository and <strong>config</strong> as the alias for the git command that will interact specifically with this repo.</p><p>For me it made more sense to call both the command and the directory simply <strong>dotfiles</strong> so the command snippets here will use my personal naming scheme.</p><h2 id=initial-setup>Initial setup</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># create bare repo</span>
</span></span><span class=line><span class=cl>git init --bare <span class=nv>$HOME</span>/.dotfiles
</span></span><span class=line><span class=cl><span class=nb>cd</span> .dotfiles/
</span></span><span class=line><span class=cl>git branch -m main  <span class=c1># renamed master to main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># create alias called &#39;dotfiles&#39; (acts as the &#39;git&#39;)</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dotfiles</span><span class=o>=</span><span class=s1>&#39;/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME&#39;</span>
</span></span><span class=line><span class=cl>dotfiles config --local status.showUntrackedFiles no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add alias to .bashrc (can also be done by hand)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;alias dotfiles=&#39;/usr/bin/git --git-dir=</span><span class=nv>$HOME</span><span class=s2>/.dotfiles/ --work-tree=</span><span class=nv>$HOME</span><span class=s2>&#39;&#34;</span> &gt;&gt; <span class=nv>$HOME</span>/.bashrc
</span></span></code></pre></div><p>I also added my dotfiles repository on GitHub as the remote repo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotfiles remote add origin https://github.com/matkv/dotfiles
</span></span><span class=line><span class=cl>dotfiles pull origin main
</span></span><span class=line><span class=cl>dotfiles push --set-upstream origin main
</span></span></code></pre></div><p>Now, any file within the home folder can be versioned with normal commands, using <strong>dotfiles</strong> instead of the normal <strong>git</strong> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># example of adding my Visual Studio code config</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> .config/Code/User <span class=c1># settings.json is located here</span>
</span></span><span class=line><span class=cl>dotfiles add settings.json
</span></span><span class=line><span class=cl>doftiles commit -m <span class=s1>&#39;added VS Code config&#39;</span>
</span></span><span class=line><span class=cl>dotfiles push
</span></span></code></pre></div><h2 id=viewing-all-currently-tracked-files>Viewing all currently tracked files</h2><p>If I want to see all the files that I&rsquo;m currently tracking in my bare repository, I can use this command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotfiles ls-tree --full-tree -r HEAD
</span></span></code></pre></div><h2 id=setting-up-this-existing-repository-on-a-new-system>Setting up this existing repository on a new system</h2><ul><li>make sure that the alias is set up in the <strong>.bashrc</strong> file<ul><li><code>echo "alias dotfiles='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME'" >> $HOME/</code></li></ul></li><li>add the dotfiles repository (that hasn&rsquo;t been cloned yet) to the <strong>.gitignore</strong> file in the home directory<ul><li><code>echo ".dotfiles" >> .gitignore</code></li></ul></li><li>clone the actual repository from GitHub<ul><li><code>git clone --bare &lt;git-repo-url> $HOME/.dotfiles</code></li></ul></li><li>define the alias in the current shell scope<ul><li><code>alias dotfiles='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME'</code></li></ul></li><li>checkout the actual content from the bare repository<ul><li><code>dotfiles checkout</code></li><li>this step might fail because some files (for exampe .gitignore) already exist - these have to be backed up & removed so this might need a little bit of tinkering</li></ul></li><li>set the <code>showUntrackedFiles</code> to no again for this repository<ul><li><code>dotfiles config --local status.showUntrackedFiles no</code></li></ul></li></ul><p>Now it should be possible to use the <strong>dotfiles</strong> command again to interact with the dotfiles repository :)</p><h2 id=next-steps>Next steps</h2><p>Now that this is set up, I want to only add files to this repository that actually have some custom stuff that was changed by me personally. If a config file is still exactly the same way it was after I installed Manjaro, I don&rsquo;t really see why I should track it.</p><p>I also want to clean up my <strong>.bashrc</strong> file before commiting because there&rsquo;s a suprising amount of weird stuff in there already.</p><p>But all in all I&rsquo;m pretty happy with the result, now I can finally start tidying up all my config files.</p></main><footer><div class=footer><div class=construction>This site is still a work in progress, some content might be missing or incomplete & the styling might look
        weird.</div><p>&copy; 2024 | matkv</p></div></footer></body></html>